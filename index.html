<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Fahim Sky Survival Mobile</title>
<style>
*{margin:0;padding:0;box-sizing:border-box;}
body{
height:100vh;
overflow:hidden;
font-family:Segoe UI;
background: linear-gradient(to bottom, #87ceeb 0%, #f0f8ff 100%);
position:relative;
}

.airplane{
position:absolute;
top:0;
font-size:36px;
opacity:0.7;
animation:airplaneMove linear infinite;
}

@keyframes airplaneMove{
0%{transform:translateX(-100px);}
100%{transform:translateX(110vw);}
}

header{
display:flex;
justify-content:space-between;
padding:10px;
background:rgba(255,255,255,.3);
backdrop-filter:blur(5px);
border-radius:10px;
font-size:14px;
}

#player{
width:70px;
position:absolute;
border-radius:50%;
box-shadow:0 0 15px cyan;
touch-action: none; /* prevent scrolling on drag */
}

.enemy, .health, .minus{
position:absolute;
border-radius:50%;
animation-name:fall;
animation-timing-function:linear;
}
.enemy{width:50px;}
.health, .minus{width:40px;}

@keyframes fall{
0%{transform:translateY(-100px);}
100%{transform:translateY(110vh);}
}

.center{
position:absolute;
top:50%;
left:50%;
transform:translate(-50%,-50%);
text-align:center;
}

button{
padding:10px 20px;
border:none;
border-radius:30px;
background:#ff004c;
color:white;
font-size:16px;
cursor:pointer;
}

#overlay{
position:fixed;
width:100%;
height:100%;
background:rgba(0,0,0,.8);
display:none;
justify-content:center;
align-items:center;
flex-direction:column;
text-align:center;
}

#overlay h1, #overlay h2{
color:white;
font-weight:bold;
text-shadow: 2px 2px 4px black;
margin:5px 0;
}
</style>
</head>
<body>

<!-- Airplanes -->
<div class="airplane" style="top:50px;animation-duration:60s;">üõ©Ô∏è</div>
<div class="airplane" style="top:120px;animation-duration:80s;">üõ©Ô∏è</div>

<header>
<div>Score: <span id="score">0</span></div>
<div>‚ù§Ô∏è Lives: <span id="lives">3</span></div>
<div>High Score: <span id="highScore">0</span></div>
</header>

<div class="center" id="startScreen">
<h1>üå§ Fahim Sky Survival</h1>
<button onclick="startGame()">Start Game</button>
</div>

<img src="fahim.png" id="player">

<div id="overlay">
<h1>üíÄ Game Over</h1>
<h2>Score: <span id="finalScore"></span></h2>
<button onclick="location.reload()">Restart</button>
</div>

<audio id="explodeSound" src="explode.mp3"></audio>
<audio id="healthSound" src="health.mp3"></audio>
<audio id="minusSound" src="minus.mp3"></audio>
<audio id="bgMusic" src="bgmusic.mp3" loop></audio>

<script>
let score=0;
let lives=3;
let maxLives=5;
let gameActive=false;
let highScore=localStorage.getItem("highScore")||0;
document.getElementById("highScore").innerText=highScore;

const player=document.getElementById("player");
const explodeSound=document.getElementById("explodeSound");
const healthSound=document.getElementById("healthSound");
const minusSound=document.getElementById("minusSound");
const bgMusic=document.getElementById("bgMusic");

bgMusic.volume=0.3;
const baseFallDuration=6;

// --- Drag to move player on mobile ---
let dragging=false;

player.addEventListener("touchstart",(e)=>{
    dragging=true;
});

player.addEventListener("touchend",(e)=>{
    dragging=false;
});

player.addEventListener("touchmove",(e)=>{
    if(!dragging) return;
    let touch = e.touches[0];
    player.style.left = (touch.pageX - player.offsetWidth/2) + "px";
    player.style.top = (touch.pageY - player.offsetHeight/2) + "px";
    e.preventDefault();
});

// Also support mouse drag on PC
player.addEventListener("mousedown",(e)=>{ dragging=true; });
player.addEventListener("mouseup",(e)=>{ dragging=false; });
player.addEventListener("mousemove",(e)=>{
    if(dragging){
        player.style.left = e.pageX - player.offsetWidth/2 + "px";
        player.style.top = e.pageY - player.offsetHeight/2 + "px";
    }
});

function startGame(){
    document.getElementById("startScreen").style.display="none";
    player.style.display="block";
    gameActive=true;
    bgMusic.play();
    spawnEnemy();
    spawnHealth();
    spawnMinus();
}

function getSpeedMultiplier(){
    if(score>=30) return 2.5;
    if(score>=20) return 2;
    if(score>=10) return 1.5;
    return 1;
}

// --- Enemy (-1 life), fewer enemies for mobile ---
function spawnEnemy(){
    if(!gameActive) return;
    if(Math.random()<0.6){ // reduce enemy spawn probability
        let enemy=document.createElement("img");
        enemy.src="fahim2.png";
        enemy.className="enemy";
        enemy.style.left=Math.random()*(window.innerWidth-50)+"px";
        let duration = baseFallDuration/getSpeedMultiplier();
        enemy.style.animationDuration = duration+"s";
        document.body.appendChild(enemy);

        let check=setInterval(()=>{
            if(checkCollision(player,enemy)){
                enemy.remove();
                clearInterval(check);
                loseLife();
            }
        },10);

        setTimeout(()=>{
            enemy.remove();
            clearInterval(check);
            if(gameActive){
                score++;
                document.getElementById("score").innerText=score;
            }
        },duration*1000);
    }
    setTimeout(spawnEnemy, 1200); // slower spawn for mobile
}

// Health (+1 life)
function spawnHealth(){
    if(!gameActive) return;
    let item=document.createElement("img");
    item.src="health.png";
    item.className="health";
    item.style.left=Math.random()*(window.innerWidth-40)+"px";
    let duration = 5;
    item.style.animationDuration = duration+"s";
    document.body.appendChild(item);

    let check=setInterval(()=>{
        if(checkCollision(player,item)){
            item.remove();
            clearInterval(check);
            gainLife();
        }
    },10);

    setTimeout(()=>{
        item.remove();
        clearInterval(check);
    }, duration*1000);

    setTimeout(spawnHealth, 8000);
}

// Minus (instant game over)
function spawnMinus(){
    if(!gameActive) return;
    let item=document.createElement("img");
    item.src="minus.png";
    item.className="minus";
    item.style.left=Math.random()*(window.innerWidth-40)+"px";
    let duration = 5;
    item.style.animationDuration = duration+"s";
    document.body.appendChild(item);

    let check=setInterval(()=>{
        if(checkCollision(player,item)){
            item.remove();
            clearInterval(check);
            minusHit();
        }
    },10);

    setTimeout(()=>{
        item.remove();
        clearInterval(check);
    }, duration*1000);

    setTimeout(spawnMinus, 12000);
}

// --- Life functions ---
function gainLife(){
    if(lives<maxLives){
        lives++;
        document.getElementById("lives").innerText=lives;
        healthSound.currentTime=0;
        healthSound.play();
    }
}

function loseLife(){
    lives--;
    document.getElementById("lives").innerText=lives;
    explodeSound.play();
    if(navigator.vibrate){navigator.vibrate(200);}
    if(lives<=0) endGame();
}

// Minus = instant game over
function minusHit(){
    minusSound.play();
    if(navigator.vibrate){navigator.vibrate(300);}
    endGame();
}

// Collision detection
function checkCollision(a,b){
    let r1=a.getBoundingClientRect();
    let r2=b.getBoundingClientRect();
    return !(r1.top>r2.bottom||r1.bottom<r2.top||r1.right<r2.left||r1.left>r2.right);
}

// End game
function endGame(){
    gameActive=false;
    bgMusic.pause();
    if(score>highScore){ localStorage.setItem("highScore",score); }
    document.getElementById("finalScore").innerText = score;
    document.getElementById("overlay").style.display = "flex";
}
</script>

</body>
</html>
